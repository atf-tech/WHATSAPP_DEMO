{% extends "chat/base.html" %}
{% block content %}

<style>
  .container {
    display: flex;
    height: calc(100vh - 50px);
  }

  .sidebar {
    width: 30%;
    background: white;
    border-right: 1px solid #ddd;
    overflow-y: auto;
  }

  .chat-area {
    width: 70%;
    background: #e5ddd5;
  }

  .chat-item {
    padding: 12px;
    border-bottom: 1px solid #eee;
    cursor: pointer;
  }

  .chat-item:hover {
    background: #f5f5f5;
  }

  .phone {
    font-weight: bold;
  }

  .preview {
    font-size: 13px;
    color: #555;
  }
</style>

<div class="container">

  <!-- LEFT: INBOX -->
  <div class="sidebar">
    {% for convo in conversations %}
      <div class="chat-item"
     hx-get="{% url 'conversation' convo.id %}"
     hx-target="#chat-box"
     hx-swap="innerHTML"
     hx-on="click: document.querySelectorAll('.chat-item').forEach(i=>i.style.background=''); this.style.background='#e9edef';">


        <div class="phone">{{ convo.donor.phone_number }}</div>
        <div class="preview">
          {{ convo.messages.last.body|default:"No messages yet" }}
        </div>

      </div>
    {% empty %}
      <p style="padding:15px;">No conversations</p>
    {% endfor %}
  </div>

  <!-- RIGHT: CHAT -->
  <div class="chat-area" id="chat-box">
    <p style="padding:20px;">Select a conversation</p>
  </div>

</div>

{% endblock %}
